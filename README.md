# External DB Connect - Laravel package

This module will connect with an external database to periodically pull in data stored in another database. The metrics can that you want to pull in have to be defined in the migration columns in the `config` file and the migration is generated by an Artisan command.

***

## Installation

1. Require the package with `composer require basduchambre/external-db-connect` (not working, not on packagist yet...)
2. Install the package with `php artisan externaldb:install`
3. This will publish a config file in your Laravel config dirictory named `externaldb.php`
4. Configure the database connection settings and the columns to be fetched, make sure the naming of the columns is identical to the columns that you're targeting
5. To generate the migration file for your table and model, use the command `php artisan externaldb:generate`

## Requirements

- Remote access has to be enabled on the database that will be called upon

## Package includes the following (unfinished)

- Service provider
- Config file
    - External DB connect settings
    - Columns for migration
    - Metrics to pull identified by migration column names
- Migration file
- Model
- Artisan command to generate migration and model based on config

## Deliverables

By creating a composer package it will be easy to add this to the core API, or leave it out when not needed.

## Usage

To retreive data from the external database, create a custom `route` and `Controller`. An example is given below.

```
namespace App\Http\Controllers;

class ExampleController extends Controller
{
    public function mist()
    {
        return ExternalDbConnect::get();
    }
}
```

### Parameters

The ExternalDbConnect class has two methods you can use to filter the data:

- start - The start DateTime for the data you want to retrieve.
- end - The end DateTime for the data you want to retrieve. Default is the current time.

These methods can be chained like the example below: 

```
return ExternalDbConnect::start('2021-06-26')
    ->end('2021-06-29')
    ->get()
```